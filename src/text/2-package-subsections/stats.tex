\subsection{gammapy.stats}
\label{ssec:gammapy-stats}
The \code{gammapy.stats} subpackage contains the fit statistics and associated
statistical estimators that are commonly used in \gammaray astronomy. In
general, \gammaray observations count Poisson-distributed events at various sky
positions, and contain both signal and background events. Estimation of the
number of signal events is done through likelihood maximization. In Gammapy,
the fit statistics are Poisson log-likelihood functions normalized like
chi-squares, i.e., they follow the expression $2 \times log L$, where $L$ is
the likelihood function used. The statistic function used when the expected
number of background events is known is the \emph{Cash} statistic
~\citep{Cash}. It is used by datasets using background templates such as the
\code{MapDataset}. When the number of background events is unknown and an off
measurement where only background events are expected is used, the statistic
function is WStat. It is a profile log-likelihood statistic where background
counts are marginalized parameters. It is used by datasets containing off
counts measurements such as the SpectrumDatasetOnOff, used for classical
spectral analysis.

To perform simple statistical estimations on counts measurements,
CountsStatistic classes encapsulate the aforementioned statistic functions to
measure excess counts and estimate the associated statistical significance,
errors and upper limits. They perform maximum likelihood ratio tests to
estimate significance (the square root of the statistic difference) and compute
likelihood profiles to measure errors and upper limits. The code example
\ref{codeexample:stats} shows how to compute the Li \& Ma
significance~\citep{LiMa} of a set of measurements.

\begin{figure}
	\import{code-examples/generated/}{gp_stats}
	\caption{
        Using \code{gammapy.stats} to compute statistical quantities
        such as excess, signficance and assymetric errors
        from counts based data. The data is passed on initialisation
        of the \code{WStatCountsStatistic} class. The quantities
        are the computed on access of the corresponding class
        attributes such as \code{.n\_sig} and \code{.sqrt\_ts}.
    }
	\label{codeexample:stats} \end{figure}

